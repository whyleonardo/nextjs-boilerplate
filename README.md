# Next.js Production Boilerplate

A minimal, production-ready Next.js starter with modern tooling and authentication wired up — no demo content, ready to build on.

## Stack

- **Next.js 16** (App Router, React 19, Turbopack)
- **TypeScript** + **Tailwind CSS v4**
- **bun** package manager
- **shadcn/ui** component library
- **better-auth** authentication (email/password, extendable)
- **Drizzle ORM** + **PostgreSQL**
- **oRPC** type-safe API layer
- **TanStack Query v5** data fetching
- **TanStack DB** client-side collections
- **Zustand** global state (with persist)
- **React Hook Form** + **Zod** validation

## Quick Start

```bash
# Clone and install
git clone https://github.com/whyleonardo/nextjs-boilerplate.git
cd nextjs-boilerplate
bun install

# Set up environment
cp .env.example .env.local
# Edit .env.local — set BETTER_AUTH_SECRET to a random 32+ char string

# Start PostgreSQL
docker compose up -d

# Push database schema
bun run db:push

# Start dev server
bun run dev
```

Visit [http://localhost:3000](http://localhost:3000)

## Project Structure

```
src/
  app/                          # Next.js App Router
    (auth)/                     # Auth pages (sign-in, sign-up)
    (dashboard)/dashboard/      # Protected route example
    api/
      auth/[...all]/            # better-auth API
      rpc/[[...rest]]/          # oRPC API
  features/                     # Feature-based modules
    auth/components/            # Client components (forms, etc.)
  components/                   # Shared components
    ui/                         # shadcn/ui primitives
    auth/                       # Auth components (user-button)
  lib/                          # Client utilities
    auth/
      client.ts                 # better-auth React client
      session.ts                # Server-side session helpers
    orpc/                       # oRPC client + server caller
    query/                      # TanStack Query hydration
  server/                       # Server-only code
    auth/                       # better-auth config
    db/                         # Drizzle client + schema
    rpc/                        # oRPC router + procedures
  stores/                       # Zustand stores
```

## Authentication

Server-side route guards live in Server Components — no middleware.

**Protect a page:**
```tsx
import { requireSession } from "@/lib/auth/session";

export default async function ProtectedPage() {
  const { user } = await requireSession(); // Redirects to /sign-in if not authenticated
  return <div>Hello {user.email}</div>;
}
```

**Redirect authenticated users away from auth pages:**
```tsx
import { requireGuest } from "@/lib/auth/session";

export default async function AuthLayout({ children }) {
  await requireGuest(); // Redirects to /dashboard if already signed in
  return <div>{children}</div>;
}
```

## Database

```bash
bun run db:generate   # Generate migration from schema changes
bun run db:migrate    # Run migrations
bun run db:push       # Push schema to DB (dev only)
bun run db:studio     # Open Drizzle Studio
```

Schema files live in `src/server/db/schema/`. The `auth.ts` schema is auto-generated by better-auth.

## API (oRPC)

Add procedures in `src/server/rpc/procedures/` and wire them into `src/server/rpc/index.ts`.

**Example procedure:**
```ts
// src/server/rpc/procedures/hello.ts
import { publicProcedure } from "../middleware";
import { z } from "zod";

export const hello = publicProcedure
  .input(z.object({ name: z.string() }))
  .handler(({ input }) => {
    return { message: `Hello, ${input.name}` };
  });
```

**Use in client:**
```tsx
"use client";
import { orpc } from "@/lib/orpc/utils";

export function Example() {
  const { data } = orpc.hello.useQuery({ name: "World" });
  return <div>{data?.message}</div>;
}
```

## Scripts

```bash
bun run dev           # Start dev server
bun run build         # Production build
bun run start         # Start production server
bun run lint          # ESLint
```

## What's Included

- Email/password authentication (extendable to OAuth, magic links, etc.)
- Server-side session management
- Protected route example (`/dashboard`)
- Auth pages with client-side forms
- Type-safe API client (oRPC + TanStack Query)
- Database migrations + Drizzle Studio
- shadcn/ui components (button, card, input, form, dropdown, avatar, etc.)
- Minimal Zustand store with localStorage persistence
- Docker Compose PostgreSQL setup

## What's NOT Included

This is infrastructure, not a demo app. No landing page, no todo list, no dashboard layout. Build your own features on top.

## License

MIT
